import{u as D,j as e,P as B,ap as A,T as S,d as L,I as C,R as Y,ao as z,B as g,F as M,aq as K,g as q,h as V,i as X,D as J,n as Q,a7 as ee,a8 as O,ar as te,as as ne}from"./mui-vendor-DWqqgZq5.js";import{r as v,a as F}from"./react-vendor-CPL8tNzv.js";import{u as se}from"./useNpmPackages-ByUQgD2N.js";import{z as N}from"./index-Bam4KnAO.js";const re="vaporjawn",ae=1e3*60*10,ie="gh_activity_v1";function oe(t){const{type:l,created_at:u,repo:d}=t,s=d?.name||"unknown",f=u,r={id:t.id,repo:s,createdAt:f,url:void 0};let o="other",c=l,p;switch(l){case"PushEvent":{o="push";const a=Array.isArray(t.payload?.commits)?t.payload.commits.length:0,b=t.payload?.ref?.split("/").pop();c=`Pushed ${a} commit${a===1?"":"s"} to ${b||"main"}`,p=`https://github.com/${s}/commits/${b||"main"}`;break}case"PullRequestEvent":{const a=t.payload?.action,b=t.payload?.number||t.payload?.pull_request?.number;p=t.payload?.pull_request?.html_url,a==="opened"?(o="pr-open",c=`Opened PR #${b} in ${s}`):a==="closed"&&t.payload?.pull_request?.merged?(o="pr-merge",c=`Merged PR #${b} in ${s}`):(o="other",c=`PR ${a} #${b} in ${s}`);break}case"ReleaseEvent":{o="release";const a=t.payload?.release?.tag_name;p=t.payload?.release?.html_url,c=`Published release ${a||"(untagged)"} in ${s}`;break}case"ForkEvent":{o="fork",p=t.payload?.forkee?.html_url,c=`Forked ${s}`;break}case"WatchEvent":{o="star",c=`Starred ${s}`,p=`https://github.com/${s}`;break}case"IssuesEvent":{const a=t.payload?.action,b=t.payload?.issue?.number;p=t.payload?.issue?.html_url,a==="opened"?(o="issue-open",c=`Opened issue #${b} in ${s}`):(o="other",c=`Issue ${a} #${b} in ${s}`);break}case"IssueCommentEvent":{o="issue-comment";const a=t.payload?.issue?.number;p=t.payload?.comment?.html_url||t.payload?.issue?.html_url,c=`Commented on issue #${a} in ${s}`;break}default:o="other",c=l.replace(/Event$/,"")+` in ${s}`,p=`https://github.com/${s}`}return{...r,kind:o,message:c,url:p}}function le(t={}){const{username:l=re,perPage:u=30,cacheTtlMs:d=ae,includeTypes:s}=t,[f,r]=v.useState([]),[o,c]=v.useState(!1),[p,a]=v.useState(null),b=v.useRef(!1),n=`${ie}_${l}_${u}`,y=v.useCallback(()=>{try{const x=localStorage.getItem(n);if(!x)return null;const w=JSON.parse(x);return!w.fetchedAt||!Array.isArray(w.data)?null:w}catch{return null}},[n]),h=v.useCallback(x=>{try{const w={fetchedAt:Date.now(),data:x};localStorage.setItem(n,JSON.stringify(w))}catch{}},[n]),j=v.useCallback(async(x=!1)=>{if(!b.current){b.current=!0,c(!0),a(null);try{const w=`https://api.github.com/users/${encodeURIComponent(l)}/events/public?per_page=${u}`,E=await fetch(w,{headers:{Accept:"application/vnd.github+json"}});if(!E.ok)throw new Error(`GitHub activity failed (${E.status})`);let R=(await E.json()).map(oe);s&&s.length&&(R=R.filter(i=>s.includes(i.kind))),R.sort((i,$)=>new Date($.createdAt).getTime()-new Date(i.createdAt).getTime()),r(R),h(R)}catch(w){x||(w instanceof Error?a(w.message):a("Failed to load GitHub activity"))}finally{c(!1),b.current=!1}}},[l,u,s,h]);v.useEffect(()=>{const x=y();if(x){const w=Date.now()-x.fetchedAt<d;r(x.data),w||j()}else j()},[d,y,j]);const m=v.useCallback(()=>{j(!0)},[j]);return{events:f,loading:o,error:p,refresh:m}}const U=["#14b8a6","#6366f1","#f59e0b","#ec4899","#0ea5e9","#84cc16","#f43f5e","#8b5cf6"],ce={push:"Push","pr-open":"PR Opened","pr-merge":"PR Merged",release:"Release",fork:"Fork",star:"Star","issue-open":"Issue Opened","issue-comment":"Issue Comment","npm-publish":"npm Publish"},de=[{label:"Push",glyph:"â¬†",description:"Code pushed to a repository"},{label:"PR Opened",glyph:"PR",description:"Pull request opened"},{label:"PR Merged",glyph:"M",description:"Pull request merged"},{label:"Release",glyph:"â›“",description:"Release / tag published"},{label:"Fork",glyph:"â‘‚",description:"Repository forked"},{label:"Star",glyph:"â˜…",description:"Repository starred"},{label:"Issue Opened",glyph:"â—»",description:"Issue created"},{label:"Issue Comment",glyph:"ðŸ’¬",description:"Issue or PR comment"},{label:"npm Publish",glyph:"ðŸ“¦",description:"Package version published to npm"}],pe="https://www.npmjs.com/~vaporjawn",ue="https://github.com/Vaporjawn",H=30,_=16,G=H/2,T=_/2,P=36,W=52;function Z(t){try{const l=new Date(t);let d=Date.now()-l.getTime();const s=d<0;d=Math.abs(d);const f=Math.floor(d/1e3);if(f<45)return s?"in a few sec":"just now";const r=Math.floor(f/60);if(r<60)return s?`in ${r}m`:`${r}m ago`;const o=Math.floor(r/60);if(o<24)return s?`in ${o}h`:`${o}h ago`;const c=Math.floor(o/24);if(c<7)return s?`in ${c}d`:`${c}d ago`;const p=Math.floor(c/7);return p<5?s?`in ${p}w`:`${p}w ago`:l.toLocaleDateString(void 0,{month:"short",day:"numeric",year:new Date().getFullYear()===l.getFullYear()?void 0:"numeric"})}catch{return""}}function he(t){return U[t%U.length]}const me=({packages:t,loading:l,error:u,refresh:d,profileUrl:s})=>{const f=D();return e.jsx(B,{elevation:3,sx:{p:{xs:2,md:4},borderRadius:4,background:f.palette.mode==="dark"?"linear-gradient(135deg, rgba(255,255,255,0.035), rgba(255,255,255,0.018))":"linear-gradient(135deg, rgba(0,0,0,0.012), rgba(0,0,0,0.03))",backdropFilter:"blur(10px)"},children:e.jsxs(A,{spacing:2,children:[e.jsxs(A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(S,{variant:"h5",fontWeight:600,component:"h2",children:"npm Packages"}),e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(L,{title:"Refresh",children:e.jsx("span",{children:e.jsx(C,{"aria-label":"refresh npm packages",size:"small",onClick:d,disabled:l,children:e.jsx(Y,{fontSize:"small"})})})}),e.jsx(L,{title:"Open npm profile",children:e.jsx(C,{"aria-label":"open npm profile",size:"small",component:"a",href:s,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"small"})})})]})]}),e.jsx(S,{variant:"body2",sx:{opacity:.8},children:"Recently published / updated packages."}),l&&e.jsx(g,{display:"flex",justifyContent:"center",py:3,children:e.jsx(M,{size:26})}),u&&!l&&e.jsxs(K,{severity:"error",children:["Failed to load npm packages: ",u]}),!l&&!u&&e.jsxs(q,{dense:!0,"aria-label":"Recent npm packages",sx:{width:"100%"},children:[t.slice(0,8).map(r=>e.jsxs(F.Fragment,{children:[e.jsx(V,{disableGutters:!0,secondaryAction:r.npmUrl?e.jsx(C,{edge:"end","aria-label":"open package",size:"small",href:r.npmUrl,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"inherit"})}):null,children:e.jsx(X,{primary:`${r.name} @ ${r.version}`,secondary:[r.description||"",r.publishedAt?` â€¢ ${Z(r.publishedAt)}`:"",typeof r.weeklyDownloads=="number"?` â€¢ ${r.weeklyDownloads.toLocaleString()} downloads/week`:""].filter(Boolean).join(""),primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})}),e.jsx(J,{component:"li",sx:{opacity:.2}})]},r.name)),t.length===0&&e.jsx(S,{variant:"body2",sx:{opacity:.6,mt:1},children:"No published packages."})]}),e.jsx(Q,{variant:"outlined",color:"primary",href:s,target:"_blank",rel:"noopener noreferrer",sx:{alignSelf:"flex-start"},children:"View All on npm"})]})})},fe=({events:t,maxRepos:l=12,heightPerNode:u=46,legendId:d="activity-legend",orientation:s="desc",showDates:f=!0})=>{const r=D(),{lanes:o,rows:c,trunkLane:p,accessibleList:a}=v.useMemo(()=>{if(!t.length)return{lanes:[],rows:[],trunkLane:void 0,accessibleList:[]};const n=[...t].sort((i,$)=>new Date(i.createdAt).getTime()-new Date($.createdAt).getTime());s==="desc"&&n.reverse();const y=[],h=[],j=new Set;n.forEach(i=>{i.lane==="GitHub"&&i.repo?y.includes(i.repo)||y.push(i.repo):i.lane&&i.lane!=="GitHub"&&(j.has(i.lane)||(j.add(i.lane),h.push(i.lane)))});const m=["GitHub",...y,...h],x=new Map;m.slice(0,l).forEach((i,$)=>x.set(i,{label:i,color:he($),index:$}));const w=x.get("GitHub"),E=[];let k;n.forEach(i=>{const $=i.createdAt.slice(0,10);f&&$!==k&&(E.push({type:"date",date:$}),k=$);let I;i.lane==="GitHub"&&i.repo?I=i.repo:i.lane==="GitHub"?I="GitHub":I=i.lane||i.repo||"Misc",E.push({type:"event",evt:i,laneKey:I,lane:x.get(I)})});const R=E.filter(i=>i.type==="event").map(i=>{const $=i.evt,I=i.laneKey;return`${$.createdAt} â€“ ${I}: ${$.message}`});return{lanes:m.slice(0,l).map(i=>x.get(i)),rows:E,trunkLane:w,accessibleList:R}},[t,l,s,f]),b=c.length*u+16;return e.jsxs(g,{sx:{position:"relative",width:"100%",overflowX:"auto",py:2},children:[e.jsx(g,{sx:{display:"flex",flexDirection:"row",pl:W,mb:1},children:o.map(n=>{const y=n.label==="GitHub";return e.jsx(g,{sx:{width:P,mr:3,textAlign:"center",fontSize:10,color:n.color,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:y?700:500,position:"relative","&:after":y?{content:'"trunk"',position:"absolute",left:0,right:0,top:"100%",fontSize:8,letterSpacing:.5,opacity:.55}:void 0},title:n.label.split("/").pop(),children:n.label==="GitHub"?"GitHub":n.label.split("/").pop()},n.label)})}),e.jsxs(g,{sx:{position:"relative",height:b,pl:W},children:[p&&e.jsx(g,{sx:{position:"absolute",left:p.index*(P+12)+P/2,top:0,bottom:0,width:2,bgcolor:r.palette.mode==="dark"?"rgba(255,255,255,0.18)":"rgba(0,0,0,0.18)"}}),c.map((n,y)=>{const h=y*u+8;if(n.type==="date")return e.jsx(g,{sx:{position:"absolute",left:0,top:h-10,height:u,display:"flex",alignItems:"center",fontSize:11,fontWeight:600,color:"text.secondary"},children:n.date},`date-${n.date}-${y}`);if(!n.evt)return null;const{lane:j}=n,m=p?p.index*(P+12)+P/2:0,x=j?j.index*(P+12)+P/2:m,w=(()=>{switch(n.evt.kind){case"push":return"â¬†";case"pr-open":return"PR";case"pr-merge":return"M";case"release":return"â›“";case"fork":return"â‘‚";case"star":return"â˜…";case"issue-open":return"â—»";case"issue-comment":return"ðŸ’¬";case"npm-publish":return"ðŸ“¦";default:return"â—"}})(),E=ce[n.evt.kind]||n.evt.kind.charAt(0).toUpperCase()+n.evt.kind.slice(1),k=j?.label==="GitHub";return e.jsxs(F.Fragment,{children:[!k&&e.jsx(g,{sx:{position:"absolute",left:Math.min(m,x),top:h,width:Math.abs(x-m),height:2,bgcolor:j?.color||"divider",opacity:.55,pointerEvents:"none"}}),p&&e.jsx(g,{sx:{position:"absolute",left:m-T,top:h-T,width:_,height:_,borderRadius:"50%",backgroundColor:r.palette.background.paper,border:`2px solid ${r.palette.divider}`,boxSizing:"border-box",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:600,color:"text.secondary"},"aria-hidden":"true"}),e.jsx(L,{title:`${n.evt.message}
${E} â€¢ ${n.evt.repo||n.evt.lane||"GitHub"}`,children:e.jsx(g,{component:n.evt.url?"a":"div",href:n.evt.url,target:n.evt.url?"_blank":void 0,rel:n.evt.url?"noopener noreferrer":void 0,"aria-label":`${E} event in ${n.evt.repo||n.evt.lane||"GitHub"} : ${n.evt.message}`,"aria-describedby":d,tabIndex:0,sx:{position:"absolute",left:x-(k?T:G),top:h-(k?T:G),width:k?_:H,height:k?_:H,borderRadius:"50%",backgroundColor:k?r.palette.primary.main:j?.color||r.palette.secondary.main,color:r.palette.getContrastText(k?r.palette.primary.main:j?.color||r.palette.secondary.main),fontSize:k?9:12,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none",boxShadow:R=>`0 0 0 2px ${R.palette.background.default}, 0 3px 6px rgba(0,0,0,0.45)`,transition:"transform .15s, box-shadow .15s","&:hover":{transform:"scale(1.15)"},"&:focus-visible":{outline:"2px solid #fff",outlineOffset:3,transform:"scale(1.15)"}},children:w})}),e.jsxs(g,{sx:{position:"absolute",left:Math.max(x,m)+(k?T:G)+10,top:h-(k?T:G)+2,minHeight:(k?_:H)-4,display:"flex",alignItems:"center",fontSize:12,pr:2,maxWidth:`calc(100% - ${Math.max(x,m)+(k?T:G)+32}px)`,color:"text.secondary",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",pointerEvents:"none"},"aria-hidden":"true",children:[n.evt.message,e.jsxs(g,{component:"span",sx:{ml:.75,opacity:.55,fontSize:11},children:["(",E,")"]})]})]},n.evt.id)}),e.jsx(g,{component:"ol","aria-label":"Activity chronological list",sx:{position:"absolute",left:-9999,width:1,height:1,overflow:"hidden",p:0,m:0},children:a.map((n,y)=>e.jsx("li",{children:n},y))})]})]})},ge=()=>e.jsxs(g,{component:"section","aria-labelledby":"activity-legend-heading",id:"activity-legend",sx:{mt:3,p:2,borderRadius:2,border:t=>`1px solid ${t.palette.divider}`,background:t=>t.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.02)"},children:[e.jsx(S,{id:"activity-legend-heading",variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Activity Graph Legend"}),e.jsxs(S,{variant:"caption",component:"p",sx:{mb:2,lineHeight:1.4},children:["The first lane is the GitHub trunk. Each GitHub repository branches horizontally from the trunk on the row of its first visible event; connectors show the relationship. The separate ",e.jsx("strong",{children:"npm"})," lane lists package publish events. Hover or focus bubbles for details."]}),e.jsx(A,{direction:"row",flexWrap:"wrap",spacing:1.5,useFlexGap:!0,children:de.map(t=>e.jsxs(A,{direction:"row",spacing:.75,alignItems:"center",sx:{minWidth:140},children:[e.jsx(g,{"aria-hidden":!0,sx:{width:22,height:22,borderRadius:"50%",bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:t.glyph}),e.jsxs(g,{sx:{fontSize:11,lineHeight:1.2},children:[e.jsx("strong",{children:t.label}),e.jsx(g,{component:"span",sx:{ml:.5,opacity:.65},children:t.description})]})]},t.label))})]}),be=({events:t,loading:l,error:u,refresh:d,view:s,onViewChange:f,profileUrl:r,maxRepos:o=12,heightPerNode:c=46})=>{const p=D();return e.jsx(B,{elevation:5,sx:{p:{xs:2,md:4},borderRadius:4,background:p.palette.mode==="dark"?"linear-gradient(135deg, rgba(255,255,255,0.045), rgba(255,255,255,0.025))":"linear-gradient(135deg, rgba(0,0,0,0.018), rgba(0,0,0,0.04))",backdropFilter:"blur(10px)"},children:e.jsxs(A,{spacing:1,children:[e.jsxs(A,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(S,{variant:"h5",fontWeight:600,component:"h2",children:"GitHub Activity"}),e.jsxs(A,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(L,{title:"Refresh",children:e.jsx("span",{children:e.jsx(C,{"aria-label":"refresh GitHub activity",size:"small",onClick:d,disabled:l,children:e.jsx(Y,{fontSize:"small"})})})}),e.jsxs(ee,{size:"small",exclusive:!0,value:s,onChange:(a,b)=>f(b),"aria-label":"github activity view mode",children:[e.jsx(O,{value:"graph","aria-label":"graph view",children:e.jsx(te,{fontSize:"small"})}),e.jsx(O,{value:"list","aria-label":"list view",children:e.jsx(ne,{fontSize:"small"})})]}),e.jsx(L,{title:"Open GitHub profile",children:e.jsx(C,{"aria-label":"open GitHub profile",size:"small",component:"a",href:r,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"small"})})})]})]}),l&&e.jsx(g,{display:"flex",justifyContent:"center",py:4,children:e.jsx(M,{size:28})}),u&&!l&&e.jsxs(K,{severity:"error",sx:{mb:2},children:["Failed to load GitHub activity: ",u]}),!l&&!u&&s==="graph"&&e.jsxs(g,{sx:{mt:1},children:[e.jsx(fe,{events:t,maxRepos:o,heightPerNode:c}),e.jsx(ge,{}),t.length===0&&e.jsx(S,{variant:"body2",sx:{opacity:.6,mt:1},children:"No recent activity."})]}),!l&&!u&&s==="list"&&e.jsxs(q,{dense:!0,"aria-label":"Recent GitHub / npm activity list",sx:{width:"100%"},children:[t.slice(0,32).map(a=>e.jsxs(F.Fragment,{children:[e.jsx(V,{disableGutters:!0,secondaryAction:a.url?e.jsx(C,{edge:"end","aria-label":"open event",size:"small",href:a.url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"inherit"})}):null,children:e.jsx(X,{primary:a.message,secondary:`${a.lane}${a.repo?` â€¢ ${a.repo}`:""} â€¢ ${Z(a.createdAt)}`,primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})}),e.jsx(J,{component:"li",sx:{opacity:.2}})]},a.id)),t.length===0&&e.jsx(S,{variant:"body2",sx:{opacity:.6,mt:1},children:"No recent activity."})]})]})})},xe=({onRefresh:t,children:l,threshold:u=80})=>{const[d,s]=v.useState(0),[f,r]=v.useState(!1),[o,c]=v.useState(0),p=v.useRef(null),a=v.useCallback(h=>{window.scrollY===0&&c(h.touches[0].clientY)},[]),b=v.useCallback(h=>{if(o===0||window.scrollY>0||f)return;const m=h.touches[0].clientY-o;m>0&&s(Math.min(m,u*1.5))},[o,f,u]),n=v.useCallback(async()=>{if(d>=u&&!f){r(!0);try{await t()}catch(h){console.error("Refresh failed:",h)}finally{r(!1)}}s(0),c(0)},[d,u,f,t]);v.useEffect(()=>{const h=p.current;if(h)return h.addEventListener("touchstart",a,{passive:!0}),h.addEventListener("touchmove",b,{passive:!0}),h.addEventListener("touchend",n),()=>{h.removeEventListener("touchstart",a),h.removeEventListener("touchmove",b),h.removeEventListener("touchend",n)}},[o,d,f,a,b,n]);const y=Math.min(d/u*100,100);return e.jsxs(g,{ref:p,sx:{position:"relative",overflow:"hidden"},children:[e.jsx(g,{sx:{position:"absolute",top:0,left:0,right:0,height:d,display:"flex",alignItems:"center",justifyContent:"center",transition:f?"height 0.3s ease-out":"none",zIndex:1e3,bgcolor:"background.paper"},children:(d>0||f)&&e.jsx(M,{variant:f?"indeterminate":"determinate",value:y,size:30})}),e.jsx(g,{sx:{transform:`translateY(${d}px)`,transition:d===0?"transform 0.3s ease-out":"none"},children:l})]})},ke=()=>{const{events:t,loading:l,error:u,refresh:d}=le(),{packages:s,loading:f,error:r,refresh:o}=se(),[c,p]=v.useState("graph"),a=v.useCallback(y=>{y&&p(y)},[]),b=v.useMemo(()=>{const y=new Date().toISOString(),h=s.map(m=>({id:`npm:${m.name}@${m.version}:${m.publishedAt||"no-date"}`,createdAt:m.publishedAt||y,message:`${m.name} v${m.version} published`,kind:"npm-publish",lane:"npm",url:m.npmUrl}));return[...t.map(m=>({...m,lane:"GitHub"})),...h].sort((m,x)=>new Date(x.createdAt).getTime()-new Date(m.createdAt).getTime())},[t,s]),n=v.useCallback(async()=>{try{await Promise.all([d(),o()]),N.success("Activity refreshed successfully!")}catch{N.error("Failed to refresh activity")}},[d,o]);return e.jsx(xe,{onRefresh:n,children:e.jsxs(g,{sx:{maxWidth:1200,mx:"auto",px:{xs:2,md:3},py:{xs:4,md:6}},children:[e.jsx(S,{variant:"h3",fontWeight:700,gutterBottom:!0,children:"Activity"}),e.jsx(S,{variant:"body1",sx:{opacity:.75,mb:4},children:"A unified timeline of my open-source work. npm publishes appear first, with a commitâ€‘style graph of GitHub repository activity."}),e.jsx(me,{packages:s,loading:f,error:r,refresh:o,profileUrl:pe}),e.jsx(g,{sx:{mt:6},children:e.jsx(be,{events:b,loading:l,error:u,refresh:d,view:c,onViewChange:a,profileUrl:ue,maxRepos:8,heightPerNode:40})}),e.jsxs(S,{variant:"body2",sx:{mt:4,opacity:.7},children:["GitHub and npm sections use local caching with background refresh to reduce API calls while keeping activity reasonably fresh. (",t.length," GitHub events /"," ",s.length," packages)"]})]})})};export{ke as default};
//# sourceMappingURL=activityPage-CHs6UrzF.js.map
