import{u as Q,j as e,B as f,e as L,T,aq as _,F,P as N,I as H,R as W,ap as z,ar as U,h as B,i as Y,k as K,D as q,n as ee,a8 as te,a9 as V,as as ne,at as se}from"./mui-vendor-D5lUmJih.js";import{r as x,a as O}from"./react-vendor-CPL8tNzv.js";import{u as re}from"./useNpmPackages-ByUQgD2N.js";import{z as X}from"./index-Bam4KnAO.js";const ae="vaporjawn",ie=1e3*60*10,oe="gh_activity_v1";function le(t){const{type:y,created_at:b,repo:h}=t,r=h?.name||"unknown",g=b,p={id:t.id,repo:r,createdAt:g,url:void 0};let a="other",i=y,l;switch(y){case"PushEvent":{a="push";const c=Array.isArray(t.payload?.commits)?t.payload.commits.length:0,d=t.payload?.ref?.split("/").pop();i=`Pushed ${c} commit${c===1?"":"s"} to ${d||"main"}`,l=`https://github.com/${r}/commits/${d||"main"}`;break}case"PullRequestEvent":{const c=t.payload?.action,d=t.payload?.number||t.payload?.pull_request?.number;l=t.payload?.pull_request?.html_url,c==="opened"?(a="pr-open",i=`Opened PR #${d} in ${r}`):c==="closed"&&t.payload?.pull_request?.merged?(a="pr-merge",i=`Merged PR #${d} in ${r}`):(a="other",i=`PR ${c} #${d} in ${r}`);break}case"ReleaseEvent":{a="release";const c=t.payload?.release?.tag_name;l=t.payload?.release?.html_url,i=`Published release ${c||"(untagged)"} in ${r}`;break}case"ForkEvent":{a="fork",l=t.payload?.forkee?.html_url,i=`Forked ${r}`;break}case"WatchEvent":{a="star",i=`Starred ${r}`,l=`https://github.com/${r}`;break}case"IssuesEvent":{const c=t.payload?.action,d=t.payload?.issue?.number;l=t.payload?.issue?.html_url,c==="opened"?(a="issue-open",i=`Opened issue #${d} in ${r}`):(a="other",i=`Issue ${c} #${d} in ${r}`);break}case"IssueCommentEvent":{a="issue-comment";const c=t.payload?.issue?.number;l=t.payload?.comment?.html_url||t.payload?.issue?.html_url,i=`Commented on issue #${c} in ${r}`;break}default:a="other",i=y.replace(/Event$/,"")+` in ${r}`,l=`https://github.com/${r}`}return{...p,kind:a,message:i,url:l}}function ce(t={}){const{username:y=ae,perPage:b=30,cacheTtlMs:h=ie,includeTypes:r}=t,[g,p]=x.useState([]),[a,i]=x.useState(!1),[l,c]=x.useState(null),d=x.useRef(!1),$=`${oe}_${y}_${b}`,w=x.useCallback(()=>{try{const S=localStorage.getItem($);if(!S)return null;const u=JSON.parse(S);return!u.fetchedAt||!Array.isArray(u.data)?null:u}catch{return null}},[$]),m=x.useCallback(S=>{try{const u={fetchedAt:Date.now(),data:S};localStorage.setItem($,JSON.stringify(u))}catch{}},[$]),s=x.useCallback(async(S=!1)=>{if(!d.current){d.current=!0,i(!0),c(null);try{const u=`https://api.github.com/users/${encodeURIComponent(y)}/events/public?per_page=${b}`,n=await fetch(u,{headers:{Accept:"application/vnd.github+json"}});if(!n.ok)throw new Error(`GitHub activity failed (${n.status})`);let k=(await n.json()).map(le);r&&r.length&&(k=k.filter(E=>r.includes(E.kind))),k.sort((E,R)=>new Date(R.createdAt).getTime()-new Date(E.createdAt).getTime()),p(k),m(k)}catch(u){S||(u instanceof Error?c(u.message):c("Failed to load GitHub activity"))}finally{i(!1),d.current=!1}}},[y,b,r,m]);x.useEffect(()=>{const S=w();if(S){const u=Date.now()-S.fetchedAt<h;p(S.data),u||s()}else s()},[h,w,s]);const v=x.useCallback(()=>{s(!0)},[s]);return{events:g,loading:a,error:l,refresh:v}}const J=["#14b8a6","#6366f1","#f59e0b","#ec4899","#0ea5e9","#84cc16","#f43f5e","#8b5cf6"];function de(t){return J[t%J.length]}const pe=({events:t,maxRepos:y=12,heightPerNode:b=46,legendId:h="activity-legend",orientation:r="desc",showDates:g=!0})=>{const p=Q(),{lanes:a,rows:i,trunkLane:l,accessibleList:c}=x.useMemo(()=>{if(!t.length)return{lanes:[],rows:[],trunkLane:void 0,accessibleList:[]};const n=[...t].sort((o,I)=>new Date(o.createdAt).getTime()-new Date(I.createdAt).getTime());r==="desc"&&n.reverse();const A=[],k=[],E=new Set;n.forEach(o=>{o.lane==="GitHub"&&o.repo?A.includes(o.repo)||A.push(o.repo):o.lane&&o.lane!=="GitHub"&&(E.has(o.lane)||(E.add(o.lane),k.push(o.lane)))});const R=["GitHub",...A,...k],P=new Map;R.slice(0,y).forEach((o,I)=>P.set(o,{label:o,color:de(I),index:I}));const D=P.get("GitHub"),C=[];let j;n.forEach(o=>{const I=o.createdAt.slice(0,10);g&&I!==j&&(C.push({type:"date",date:I}),j=I);let G;o.lane==="GitHub"&&o.repo?G=o.repo:o.lane==="GitHub"?G="GitHub":G=o.lane||o.repo||"Misc",C.push({type:"event",evt:o,laneKey:G,lane:P.get(G)})});const M=C.filter(o=>o.type==="event").map(o=>{const I=o.evt,G=o.laneKey;return`${I.createdAt} â€“ ${G}: ${I.message}`});return{lanes:R.slice(0,y).map(o=>P.get(o)),rows:C,trunkLane:D,accessibleList:M}},[t,y,r,g]),d=36,$=52,w=30,m=16,s=w/2,v=m/2,S=i.length*b+16,u={push:"Push","pr-open":"PR Opened","pr-merge":"PR Merged",release:"Release",fork:"Fork",star:"Star","issue-open":"Issue Opened","issue-comment":"Issue Comment","npm-publish":"npm Publish"};return e.jsxs(f,{sx:{position:"relative",width:"100%",overflowX:"auto",py:2},children:[e.jsx(f,{sx:{display:"flex",flexDirection:"row",pl:$,mb:1},children:a.map(n=>{const A=n.label==="GitHub";return e.jsx(f,{sx:{width:d,mr:3,textAlign:"center",fontSize:10,color:n.color,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:A?700:500,position:"relative","&:after":A?{content:'"trunk"',position:"absolute",left:0,right:0,top:"100%",fontSize:8,letterSpacing:.5,opacity:.55}:void 0},title:n.label.split("/").pop(),children:n.label==="GitHub"?"GitHub":n.label.split("/").pop()},n.label)})}),e.jsxs(f,{sx:{position:"relative",height:S,pl:$},children:[l&&e.jsx(f,{sx:{position:"absolute",left:l.index*(d+12)+d/2,top:0,bottom:0,width:2,bgcolor:p.palette.mode==="dark"?"rgba(255,255,255,0.18)":"rgba(0,0,0,0.18)"}}),i.map((n,A)=>{const k=A*b+8;if(n.type==="date")return e.jsx(f,{sx:{position:"absolute",left:0,top:k-10,height:b,display:"flex",alignItems:"center",fontSize:11,fontWeight:600,color:"text.secondary"},children:n.date},`date-${n.date}-${A}`);if(!n.evt)return null;const{lane:E}=n,R=l?l.index*(d+12)+d/2:0,P=E?E.index*(d+12)+d/2:R,D=(()=>{switch(n.evt.kind){case"push":return"â¬†";case"pr-open":return"PR";case"pr-merge":return"M";case"release":return"â›“";case"fork":return"â‘‚";case"star":return"â˜…";case"issue-open":return"â—»";case"issue-comment":return"ðŸ’¬";case"npm-publish":return"ðŸ“¦";default:return"â—"}})(),C=u[n.evt.kind]||n.evt.kind.charAt(0).toUpperCase()+n.evt.kind.slice(1),j=E?.label==="GitHub";return e.jsxs(O.Fragment,{children:[!j&&e.jsx(f,{sx:{position:"absolute",left:Math.min(R,P),top:k,width:Math.abs(P-R),height:2,bgcolor:E?.color||"divider",opacity:.55,pointerEvents:"none"}}),l&&e.jsx(f,{sx:{position:"absolute",left:R-v,top:k-v,width:m,height:m,borderRadius:"50%",backgroundColor:p.palette.background.paper,border:`2px solid ${p.palette.divider}`,boxSizing:"border-box",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:600,color:"text.secondary"},"aria-hidden":"true"}),e.jsx(L,{title:`${n.evt.message}
${C} â€¢ ${n.evt.repo||n.evt.lane||"GitHub"}`,children:e.jsx(f,{component:n.evt.url?"a":"div",href:n.evt.url,target:n.evt.url?"_blank":void 0,rel:n.evt.url?"noopener noreferrer":void 0,"aria-label":`${C} event in ${n.evt.repo||n.evt.lane||"GitHub"} : ${n.evt.message}`,"aria-describedby":h,tabIndex:0,sx:{position:"absolute",left:P-(j?v:s),top:k-(j?v:s),width:j?m:w,height:j?m:w,borderRadius:"50%",backgroundColor:j?p.palette.primary.main:E?.color||p.palette.secondary.main,color:p.palette.getContrastText(j?p.palette.primary.main:E?.color||p.palette.secondary.main),fontSize:j?9:12,fontWeight:700,display:"flex",alignItems:"center",justifyContent:"center",textDecoration:"none",boxShadow:M=>`0 0 0 2px ${M.palette.background.default}, 0 3px 6px rgba(0,0,0,0.45)`,transition:"transform .15s, box-shadow .15s","&:hover":{transform:"scale(1.15)"},"&:focus-visible":{outline:"2px solid #fff",outlineOffset:3,transform:"scale(1.15)"}},children:D})}),e.jsxs(f,{sx:{position:"absolute",left:Math.max(P,R)+(j?v:s)+10,top:k-(j?v:s)+2,minHeight:(j?m:w)-4,display:"flex",alignItems:"center",fontSize:12,pr:2,maxWidth:`calc(100% - ${Math.max(P,R)+(j?v:s)+32}px)`,color:"text.secondary",lineHeight:1.2,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",pointerEvents:"none"},"aria-hidden":"true",children:[n.evt.message,e.jsxs(f,{component:"span",sx:{ml:.75,opacity:.55,fontSize:11},children:["(",C,")"]})]})]},n.evt.id)}),e.jsx(f,{component:"ol","aria-label":"Activity chronological list",sx:{position:"absolute",left:-9999,width:1,height:1,overflow:"hidden",p:0,m:0},children:c.map((n,A)=>e.jsx("li",{children:n},A))})]})]})},ue=[{label:"Push",glyph:"â¬†",description:"Code pushed to a repository"},{label:"PR Opened",glyph:"PR",description:"Pull request opened"},{label:"PR Merged",glyph:"M",description:"Pull request merged"},{label:"Release",glyph:"â›“",description:"Release / tag published"},{label:"Fork",glyph:"â‘‚",description:"Repository forked"},{label:"Star",glyph:"â˜…",description:"Repository starred"},{label:"Issue Opened",glyph:"â—»",description:"Issue created"},{label:"Issue Comment",glyph:"ðŸ’¬",description:"Issue or PR comment"},{label:"npm Publish",glyph:"ðŸ“¦",description:"Package version published to npm"}],he=()=>e.jsxs(f,{component:"section","aria-labelledby":"activity-legend-heading",id:"activity-legend",sx:{mt:3,p:2,borderRadius:2,border:t=>`1px solid ${t.palette.divider}`,background:t=>t.palette.mode==="dark"?"rgba(255,255,255,0.03)":"rgba(0,0,0,0.02)"},children:[e.jsx(T,{id:"activity-legend-heading",variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:"Activity Graph Legend"}),e.jsxs(T,{variant:"caption",component:"p",sx:{mb:2,lineHeight:1.4},children:["The first lane is the GitHub trunk. Each GitHub repository branches horizontally from the trunk on the row of its first visible event; connectors show the relationship. The separate ",e.jsx("strong",{children:"npm"})," lane lists package publish events. Hover or focus bubbles for details."]}),e.jsx(_,{direction:"row",flexWrap:"wrap",spacing:1.5,useFlexGap:!0,children:ue.map(t=>e.jsxs(_,{direction:"row",spacing:.75,alignItems:"center",sx:{minWidth:140},children:[e.jsx(f,{"aria-hidden":!0,sx:{width:22,height:22,borderRadius:"50%",bgcolor:"action.hover",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:t.glyph}),e.jsxs(f,{sx:{fontSize:11,lineHeight:1.2},children:[e.jsx("strong",{children:t.label}),e.jsx(f,{component:"span",sx:{ml:.5,opacity:.65},children:t.description})]})]},t.label))})]}),me=({onRefresh:t,children:y,threshold:b=80})=>{const[h,r]=x.useState(0),[g,p]=x.useState(!1),[a,i]=x.useState(0),l=x.useRef(null),c=x.useCallback(m=>{window.scrollY===0&&i(m.touches[0].clientY)},[]),d=x.useCallback(m=>{if(a===0||window.scrollY>0||g)return;const v=m.touches[0].clientY-a;v>0&&r(Math.min(v,b*1.5))},[a,g,b]),$=x.useCallback(async()=>{if(h>=b&&!g){p(!0);try{await t()}catch(m){console.error("Refresh failed:",m)}finally{p(!1)}}r(0),i(0)},[h,b,g,t]);x.useEffect(()=>{const m=l.current;if(m)return m.addEventListener("touchstart",c,{passive:!0}),m.addEventListener("touchmove",d,{passive:!0}),m.addEventListener("touchend",$),()=>{m.removeEventListener("touchstart",c),m.removeEventListener("touchmove",d),m.removeEventListener("touchend",$)}},[a,h,g,c,d,$]);const w=Math.min(h/b*100,100);return e.jsxs(f,{ref:l,sx:{position:"relative",overflow:"hidden"},children:[e.jsx(f,{sx:{position:"absolute",top:0,left:0,right:0,height:h,display:"flex",alignItems:"center",justifyContent:"center",transition:g?"height 0.3s ease-out":"none",zIndex:1e3,bgcolor:"background.paper"},children:(h>0||g)&&e.jsx(F,{variant:g?"indeterminate":"determinate",value:w,size:30})}),e.jsx(f,{sx:{transform:`translateY(${h}px)`,transition:h===0?"transform 0.3s ease-out":"none"},children:y})]})};function Z(t){try{const y=new Date(t);let h=Date.now()-y.getTime();const r=h<0;h=Math.abs(h);const g=Math.floor(h/1e3);if(g<45)return r?"in a few sec":"just now";const p=Math.floor(g/60);if(p<60)return r?`in ${p}m`:`${p}m ago`;const a=Math.floor(p/60);if(a<24)return r?`in ${a}h`:`${a}h ago`;const i=Math.floor(a/24);if(i<7)return r?`in ${i}d`:`${i}d ago`;const l=Math.floor(i/7);return l<5?r?`in ${l}w`:`${l}w ago`:y.toLocaleDateString(void 0,{month:"short",day:"numeric",year:new Date().getFullYear()===y.getFullYear()?void 0:"numeric"})}catch{return""}}const ye=()=>{const t=Q(),{events:y,loading:b,error:h,refresh:r}=ce(),{packages:g,loading:p,error:a,refresh:i}=re(),l="https://www.npmjs.com/~vaporjawn",[c,d]=x.useState("graph"),$=x.useCallback((s,v)=>{v&&d(v)},[]),w=x.useMemo(()=>{const s=new Date().toISOString(),v=g.map(u=>({id:`npm:${u.name}@${u.version}:${u.publishedAt||"no-date"}`,createdAt:u.publishedAt||s,message:`${u.name} v${u.version} published`,kind:"npm-publish",lane:"npm",url:u.npmUrl}));return[...y.map(u=>({...u,lane:"GitHub"})),...v].sort((u,n)=>new Date(n.createdAt).getTime()-new Date(u.createdAt).getTime())},[y,g]),m=x.useCallback(async()=>{try{await Promise.all([r(),i()]),X.success("Activity refreshed successfully!")}catch{X.error("Failed to refresh activity")}},[r,i]);return e.jsx(me,{onRefresh:m,children:e.jsxs(f,{sx:{maxWidth:1200,mx:"auto",px:{xs:2,md:3},py:{xs:4,md:6}},children:[e.jsx(T,{variant:"h3",fontWeight:700,gutterBottom:!0,children:"Activity"}),e.jsx(T,{variant:"body1",sx:{opacity:.75,mb:4},children:"A unified timeline of my open-source work. npm publishes appear first, with a commitâ€‘style graph of GitHub repository activity."}),e.jsx(N,{elevation:3,sx:{p:{xs:2,md:4},borderRadius:4,background:t.palette.mode==="dark"?"linear-gradient(135deg, rgba(255,255,255,0.035), rgba(255,255,255,0.018))":"linear-gradient(135deg, rgba(0,0,0,0.012), rgba(0,0,0,0.03))",backdropFilter:"blur(10px)"},children:e.jsxs(_,{spacing:2,children:[e.jsxs(_,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(T,{variant:"h5",fontWeight:600,component:"h2",children:"npm Packages"}),e.jsxs(_,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(L,{title:"Refresh",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh npm packages",size:"small",onClick:i,disabled:p,children:e.jsx(W,{fontSize:"small"})})})}),e.jsx(L,{title:"Open npm profile",children:e.jsx(H,{"aria-label":"open npm profile",size:"small",component:"a",href:l,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"small"})})})]})]}),e.jsx(T,{variant:"body2",sx:{opacity:.8},children:"Recently published / updated packages."}),p&&e.jsx(f,{display:"flex",justifyContent:"center",py:3,children:e.jsx(F,{size:26})}),a&&!p&&e.jsxs(U,{severity:"error",children:["Failed to load npm packages: ",a]}),!p&&!a&&e.jsxs(B,{dense:!0,"aria-label":"Recent npm packages",sx:{width:"100%"},children:[g.slice(0,8).map(s=>e.jsxs(O.Fragment,{children:[e.jsx(Y,{disableGutters:!0,secondaryAction:s.npmUrl?e.jsx(H,{edge:"end","aria-label":"open package",size:"small",href:s.npmUrl,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"inherit"})}):null,children:e.jsx(K,{primary:`${s.name} @ ${s.version}`,secondary:[s.description||"",s.publishedAt?` â€¢ ${Z(s.publishedAt)}`:"",typeof s.weeklyDownloads=="number"?` â€¢ ${s.weeklyDownloads.toLocaleString()} downloads/week`:""].filter(Boolean).join(""),primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})}),e.jsx(q,{component:"li",sx:{opacity:.2}})]},s.name)),g.length===0&&e.jsx(T,{variant:"body2",sx:{opacity:.6,mt:1},children:"No published packages."})]}),e.jsx(ee,{variant:"outlined",color:"primary",href:l,target:"_blank",rel:"noopener noreferrer",sx:{alignSelf:"flex-start"},children:"View All on npm"})]})}),e.jsxs(N,{elevation:5,sx:{mt:6,p:{xs:2,md:4},borderRadius:4,background:t.palette.mode==="dark"?"linear-gradient(135deg, rgba(255,255,255,0.045), rgba(255,255,255,0.025))":"linear-gradient(135deg, rgba(0,0,0,0.018), rgba(0,0,0,0.04))",backdropFilter:"blur(10px)"},children:[e.jsxs(_,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{mb:2},children:[e.jsx(T,{variant:"h5",fontWeight:600,component:"h2",children:"GitHub Activity"}),e.jsxs(_,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(L,{title:"Refresh",children:e.jsx("span",{children:e.jsx(H,{"aria-label":"refresh github activity",size:"small",onClick:r,disabled:b,children:e.jsx(W,{fontSize:"small"})})})}),e.jsxs(te,{size:"small",exclusive:!0,value:c,onChange:$,"aria-label":"github activity view mode",children:[e.jsx(V,{value:"graph","aria-label":"graph view",children:e.jsx(ne,{fontSize:"small"})}),e.jsx(V,{value:"list","aria-label":"list view",children:e.jsx(se,{fontSize:"small"})})]}),e.jsx(L,{title:"Open GitHub profile",children:e.jsx(H,{"aria-label":"open github profile",size:"small",component:"a",href:"https://github.com/Vaporjawn",target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"small"})})})]})]}),b&&e.jsx(f,{display:"flex",justifyContent:"center",py:4,children:e.jsx(F,{size:28})}),h&&!b&&e.jsxs(U,{severity:"error",sx:{mb:2},children:["Failed to load GitHub activity: ",h]}),!b&&!h&&c==="graph"&&e.jsxs(f,{sx:{mt:1},children:[e.jsx(pe,{events:w,maxRepos:8,heightPerNode:40}),e.jsx(he,{}),w.length===0&&e.jsx(T,{variant:"body2",sx:{opacity:.6,mt:1},children:"No recent activity."})]}),!b&&!h&&c==="list"&&e.jsxs(B,{dense:!0,"aria-label":"Recent GitHub / npm activity list",sx:{width:"100%"},children:[w.slice(0,32).map(s=>e.jsxs(O.Fragment,{children:[e.jsx(Y,{disableGutters:!0,secondaryAction:s.url?e.jsx(H,{edge:"end","aria-label":"open event",size:"small",href:s.url,target:"_blank",rel:"noopener noreferrer",children:e.jsx(z,{fontSize:"inherit"})}):null,children:e.jsx(K,{primary:s.message,secondary:`${s.lane}${s.repo?` â€¢ ${s.repo}`:""} â€¢ ${Z(s.createdAt)}`,primaryTypographyProps:{variant:"body2"},secondaryTypographyProps:{variant:"caption"}})}),e.jsx(q,{component:"li",sx:{opacity:.2}})]},s.id)),w.length===0&&e.jsx(T,{variant:"body2",sx:{opacity:.6,mt:1},children:"No recent activity."})]})]}),e.jsxs(T,{variant:"body2",sx:{mt:4,opacity:.7},children:["GitHub and npm sections use local caching with background refresh to reduce API calls while keeping activity reasonably fresh. (",y.length," GitHub events / ",g.length," packages)"]})]})})};export{ye as default};
//# sourceMappingURL=activityPage-BxTbN03g.js.map
